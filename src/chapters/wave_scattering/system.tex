A scalar perturbation on an arbitrary spacetime metric is governed by the Klein-Gordon equation,
%
\begin{equation}
  \nabla_\mu \nabla^\mu \Phi - m^2 \Phi = 0.
  \label{eq:wave_scattering_kg_eq}
\end{equation}
%
To make use of the spacetime evolution codes within the \texttt{EinsteinToolkit}, we must decompose Eq.~\eqref{eq:wave_scattering_kg_eq} in \ac{ADM} form. The end result of this procedure is readily available in the literature, for instance in Equations A3c and A3d of Ref.~\cite{PhysRevD.96.104040} and Sec. 3.9 of~\cite{Ficarra2023}. The 3+1 decomposed version of Eq.~\eqref{eq:wave_scattering_kg_eq} reads
%
\begin{align}
  \partial_t \Phi =   & -2 \alpha K_\phi + \mathcal{L}_\beta \Phi \label{eq:wave_scattering_a3c}                                                                                                                                                     \\
  \partial_t K_\Phi = & \alpha \left( K K_\Phi - \frac{1}{2} \gamma^{ij} D_i \partial_j \Phi + \frac{1}{2} \mu^2 \Phi \right) - \frac{1}{2} \gamma^{ij} \partial_i \alpha \partial_j \Phi + \mathcal{L}_\beta K_\Phi, \label{eq:wave_scattering_a3d}
\end{align}
%
where $\Phi$ is the scalar field being evolved, $K_\Phi$ its ``canonical momentum'', given by
%
\begin{equation}
  K_\Phi = -\frac{1}{2\alpha} \left( \partial_t - \mathcal{L}_\beta \right)\Phi,
  \label{eq:wave_scattering_a2}
\end{equation}
%
$\alpha$ is the spacetime lapse, $\beta^i$ its shift vector, $\gamma^{ij}$ its induced 3-metric, $K$ the trace of its extrinsic curvature tensor, $D_i$ the covariant derivative associated with $\gamma^{ij}$, $\mu$ the spacetime mass parameter and $\mathcal{L}_\beta$ is the Lie derivative along the shift vector $\beta^i$, given explicitly by
%
\begin{equation}
  \mathcal{L}_\beta\Phi = \beta^i \partial_i \Phi.
  \label{eq:wave_scattering_lie_derivative}
\end{equation}

To incorporate Eqs.~\eqref{eq:wave_scattering_a3c} and \eqref{eq:wave_scattering_a3c} into the \texttt{EinsteinToolkit}, the RHSs of these equations need to be computed at each time step using metric quantities. During the evolution of spacetime, the \texttt{Thorns} for metric evolution utilize the \texttt{ADMBase Thorn} interface, which provides the $3+1$ decomposition variables at each grid point and time step. However, it should be noted that the presence of the spatial covariant derivative operator $D_i$ necessitates the computation of spatial derivatives of the spatial metric $\gamma_{i,j}$. Additionally, it is necessary to manually compute the trace of the extrinsic curvature tensor.

Performing these additional calculations manually can be error-prone and time-consuming. To ensure consistency and automation, we have utilized the computer algebra system \texttt{Wolfram Mathematica} to generate \texttt{C} code from the analytic representation of the system. The relevant code can be found in the \texttt{Notebooks/equations.nb} file located in the \texttt{KleinGordon} folder of the \texttt{Thorn}'s repository as referenced in Ref.~\cite{FieldPerturbationsRepo}.